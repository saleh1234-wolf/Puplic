<html>
<head>
<title>
شـ❣ـہرحـ❣ـہ مـ❣ـہفـ❣ـہصـ❣ـہل عـ❣ـہنـ❣ـہ آلمـ❣ـہيتـ❣ـہآسـ❣ـہبـ❣ـہلوُيتـ❣ـہ 
</title>
</head>
<body dir="rtl"bgcolor="black"LINK="green"
VLINK="white"
alink="red"><font size="20"color="white">
<form> 
<a href="termax.html">للرجوع</a><br>
<center></center>
شرح مشروع الميتاسبلويت من الصفر<br>
ماهو مشروع الميتاسبلويت؟<br>
الميتاسبلويت Metasploit هي ليست مجرد مشروع مفتوح المصدر! بل هو مشروع يهتم بالأمن المعلوماتي عبر البحث عن الثغرات الأمنية ويساعد في اختبارات الإختراق وتطوير أنظمة كشف التسللات IDS. وأهم إنجازات هذا المشروع هو منصة ميتاسبلوت المفتوحة المصدر وهي أداة تقوم بفتح منفذ في الجهاز المستهدف بهدف اختراقه.<br><br><br>


أنشأت ميتاسبلوت من قبل فريق HD Moore سنة 2003، كأداة شبكية محمولة مبرمجة بلغة Perl. سنة 2007 ثم أعيد برمجتها كليا بواسطة لغة Ruby. سنة 2009 . أعلن أنه وقع الإستحواذ عليها من قبل شركة Rapid7، وهي شركة أمنية تبحث عن نقاط الضعف في الأنظمة وتقدم حلول لها.<br>
الميتاسبلويت سلاح ذو حدين<br>
كما يمكن استعمال Metasploit للبحث عن ثغرات الأنظمة فإنه يمكن من استغلالها بطريقة غير شرعية لاختراق الانظمة المختلفة.<br>
فهي تعتبر سلاح سواء في يد الجيد Good وللسيء Bad وللغبي Ugly<br><br>

ألية العمل بالميتاسبلويت<br><br>

بشكل عام يمكن تلخيص مهام مشروع الميتاسبلويت لاختراق هدف بخطوات او مراحل كالأتي<br>
اختيار واعداد الثغرة Exploit لعمل الهجوم (باختيار واحدة من بين أكثر من 1577 ثغرة موجودة على مختلف الانظمة من وندوز، ماك أو لينكس)<br>
التحقق من أن النظام المستهدف يمكن تطبيق الإختراق عليه (بمعنى التحقق من ان الجهاز مصاب فعليا بثغرة)<br>
اختيار واعداد البايلود Payload (وهو برمجية ضارة يرسلها المخترق للضحية لفتح قناة تواصل وتشبه في طريقة عملها فيروس حصان طروادة أو فيروس الدودة )<br>
اختيار طريقة لتشفير البايلود Encoding Payload لتجاوز أنظمة كشف التسللات و كتلك تخطي الأنتي فايروس  Bypass AV.<br>
المرحلة الاخيرة تنفيذ الهجمة أو تشغيل الثغرة Run Exploit.<br>
هذه الخطوات المتبعة لتنفيذ أي هجوم عبر أي بايلود وعمل الميتاسبلوت هنا هو تسهيل عمل المخترقين. كما نذكر أن الميتاسبلوت يعمل على أغلب أنظمة Unix (تشمل لينكس والماك) والوندوز وهو متوفر بعدة لغات.<br><br>

مكونات مشروع الميتاسبلويت الاساسية<br><br>

يجب عليك كمبتدئ معرفة كل شيء عن هذا السلاح الفتاك حتى تمضي قدما في طريق الاحتراف<br>
مشروع الميتاسبلويت مبني على عدة مكونات أساسية, وكل بنية تمثل مجال بحد ذاته, تابع معي رعاك الله سنذكر هذه اللبنات الأساسية باللغة الانجليزية مع ترجمة بسيطة باللغة العربية حتى تستوعب, لكن يجب عليك التعامل بالمصطلحات الانجليزية اذا أردت الاحتراف فخذ الصنعة من صانعها.<br><br>

Architecture - هندسة أو مخطط المشروع<br>
Components - المكونات<br>
Libraries - المكتبات<br>
Interfaces - واجهات<br>
Modules - وحدات<br>
Utilities - خدمات<br>
Plugins - الإضافات<br>

1- MSF Architecture<br>
هي أشبه بدولة داخلها مؤسسات<br><br>

2- المكونات MSF Components<br><br>

مشروع الميتاسبلويت يعتمد على بعض المكونات مثل:<br><br>

  MSF Libraries<br>
  ‏ Interfaces<br>
  ‏ Modules<br>
  ‏ Mixins<br>
  ‏ Plugins<br>
3- المكتبات أو MSF Libraries<br><br>

تتكون هذه المكتبات من ثلاث أقسام: Rex, Core, Base<br>
1- REX وهي اختصار لجملة Ruby Extension Library<br><br>

ملحوظة: (طبعا الروبي Ruby هي لغة برمجة وقد تم برمجة بها مشروع الميتاسبلويت, و Extension Library تعني مكاتب اضافية أو امتداد)<br>
تحتوي REX على السوكيت والبروتوكولات والتحويلات النصية وغيرها من التشفيرات وبروتوكولات الشبكة.<br>
Sockets, protocols, text transformations و SMB و SSL و HTTP و XOR و BASE64 <br><br>

2- النواة  (Msf::Core (Core library:<br>
يمكن تقسيمها لقسمين:<br>
الأول الثغرات أوالاستغلالات Exploits<br>
وهي مختلفة مثل ثغرات موجودة بقواعد البيانات والبروتوكولاتوغيرها  Oracle ,MSSQL ,FTP, HTTP, SMB<br>
القسم الثاني هو الاضافات Auxiliary<br>
مثل برامج الفحص  Scanners وبرامج التخمين BruteForce وبرامج التبليغ Reports ... <br>
وبرامج حجب الخدمة DOS و Fuzzers و Wireless<br><br>

3- (Msf::Base (Base library  :<br>
يوفر إجراءات  وفئات classes التي يمكنك استخدامها للعمل بسهولة مع  النواة  Core<br><br>

4- واجهات المشروع Metasploit Interfaces<br><br>

يتكون مشروع الميتاسبلويت من أربعة واجهات أساسية مختلفة, يمكننا عن طريق هذه الواجهات بالتعامل مع الميتاسبلويت بسهولة ومرونة<br><br>

MSFconsole تمثل الواجهة الاساسية ونتعامل معها بالاوامر مثل شاشة الدوس<br>
MSFcli تشبه التعامل مع السكريبتات<br>
MSFweb نتعامل معها عن طريق فتح متصفح الانترنت<br>
MSFgui  و Armitage من أسهل وأروع الواجهات المبرمجة بلغة الجافا القوية , وهي تأتي مع نظام الكالي لينكس أنصح المبتدئين باستعمالها و بشدة. ولكن هذا لا يعني اهمال msfconsole<br><br>

5- الوحدات MSF Modules<br><br>

تتكون الوحدات من عدة برامج وسكريبتات مهمة مثل:<br>
Exploit<br>
Auxiliary<br>
Post-Exploitation<br>
Payload<br>
NOP generator<br>
Payload encoder<br>
لا يمكن شرحها الان فهي أشياء متقدمة حاليا.<br>
6- الخدمات والادوات MSF Utilities<br>
هناك ثلاث أدوات رئيسية مهمة مثل :<br>
MSFpayload<br>
ويمكنك تشبيهه بالسيرفر أو التروجان الذي نرسله للضحية بق<br><br>

صد اختراقه وله عدة اشكال مثلا الشيل كود shellcode والذي يمكن ارساله عن طريق الاي بي  بشكل ثنائي Binary.<br><br>

MSFencode<br>
هي أداة تشفير الفيروسات والشيل كود, والتخلص من Bad Chars.<br><br>

Msfvenom<br>
هي اداة جديدة تجمع بين الاداة الاولى والثانية,  لأنه تم التخلي عنهما وتغييرها بالاداة القوية MSFVENOM<br><br>

7- الاضافات MSF Plugins<br>
هي ميزة تقدمها لك الميتاسبلويت للتحكم بها أوتوماتيكيا عن طريق دوال تسمى API بحيث يمكنك برمجة أداة تقوم بتطبيق ثغرة او فحص وغيرها ... وذلك بتطويع الميتاسبلويت وجعلها بخدمتها.<br>
ولا تقتصر على هذا فقط, بل يمكنك اضافة أوامر جديدة للمشروع بواسطة برمجة اضافة خاصة بك Plugin.<br><br>

أوامر الميتاسبلويت MSF Commands<br><br>

أولا لفتح مشروع الميتاسبلويت في الكالي لينكس نكتب في الطرفية الامر الأتي<br><br>

msfconsole<br><br>

 الامر help<br>
 ‏لمعرفة جميع أوامر الميتاسبلويت أكتب<br>
help<br>
help<br><br>

الأمر Clear<br>
نحتاجه أحيانا لمسح الكتابة من على الشاشة وهو نفس الأمر يعمل على اللينكس<br><br>

clear<br>
الأمر show exploits<br>
لاستعراض جميع الثغرات الموجودة بالميتاسبلويت نستعمل الامر<br><br>

show exploits<br><br>

 تظهر لنا أسماء الثغرات Exploit-Name  وتاريخ اكتشافها ومدى خطورتها  RANK  و الوصف<br>
 ومسارها على جهازك مثال<br>
 ‏windows/browser/adobe_flash_avm2<br>
 ‏كما تلاحظ موجودة داخل مجلد ويندوز داخل مجلد المتصفح وتحمل اسم فلاش , بمعنى ان هذه الثغرة يمكنها اختراق الويندوز عن طريق ثغرة الفلاش بلاير الخاص بالمتصفج.<br><br>
 ‏
 ‏الأمر use<br><br>
 ‏نحتاج هذا الامر لاستعمال ثغرة معينة. , بحيث نكتب الامر use ونكتب أمامه اسم ومسار الثغرة<br><br>
use exploit_Name<br>
مثال:<br>
نستعمل هذه الثغرة الشهيرة ms08_067_netapi التي تسببت باختراق الويندوز اكس بي<br><br>

use exploit/windows/smb/ms08_067_netapi<br><br>

الامر show options<br>
هذا الامر يظهر لنا خيارات الثغرة أو الاستغلال, بحيث يعطينا متطلبات الثغرة مثل الايبي الخاص بالضحية والبورت وغيرها, فهي تختلف من ثغرة لاخرى.<br><br>

الأمر SET<br>
نحتاج هذا الأمر لتعيين قيمة, فمثلا عندما تحتاج الثغرة لبورت أو هوست نقوم بادخاله بالامرSET
فمثلا هذا الامر لادخال الهوست على سبيل المثال عنوان اي بي الضحية هو 192.168.1.15<br>
set RHOST 192.168.1.15<br><br>

وهذا الامر لادخال البورت على سبيل المثال بورت 445<br>
set RPORT 445<br><br>
<br>

ملاحظة:<br>
كما تلاحظ RHOST  أو RPORT الحرف R يعني ريموت Remote بمعنى اننا نستهدف هوست أو بورت بعيد(victime)<br>,
وعندما تجد LHOST أو LPORT فالحرف L هنا يعني Locale بمعنى المحلي, فبعض الثغرات تحتاج هوست أو لبورت جهازك لتستقبل عليه البيانات من الضحية.<br>
<br>
الأمر exploit و run<br>
في الحقيقة هذان الأمران لهما نفس الدور وهو تشغيل أو تنفيذ الثغرة, فبعدما قمنا بادخال متطلبات الثغرة بقي علينا تنفيذها للاختراق<br>
الأمر exploit و run<br><br>

تطبيق عملي طريقة اختراق وبندوز Windows XP<br><br>

سنحاول اختراق ويندوز اكس بي مصاب بالثغرة الشهيرة ms08_067_netapi وهذه الثغرة موجودة في خدمة SMB طبعا هذه الخدمة خاصة بمشاركة الملفات.<br>
الخطوات الاساسية للاختراق بالميتاسبلويت بشكل عام هي<br><br>

اختيار الثغرة بالامر use<br><br>


<br>
نقوم باظهار متطلبات الثغرة بالامر show options ,<br><br><br>


نقوم بادخال متطلبات الثغرة  (مثل ip, Port. url. وغيره من المتطلبات على حسب الثغرة) عن طريق الامر SET<br><br><br>


الخطوة الاخيرة استعمال بايلود , يتم ارساله للضحية بعد ان يتم الاختراق, حتى نتحكم في النظام المستهدف.<br><br><br>


المرحلة الأخيرة تنفيذ الاختراق Exploit<br><br>

تم الاختراق<br><br><br>


هذه عملية أخرى لمحاولة اختراق ويندوز اكسبي ولكن الثغرة كانت مرقعة<br><br>

في هذا المثال قمت باستعمال الامر check وهو يقوم بالتحقق من الجهاز المستهدف هل يمكن تطبيق الثغرة عليه ام لا<br>
لاحظ الصورة<br><br>

check<br><br>

لم يتم الاختراق فالنظام غير مصاب, أو تم تحديث النظام<br><br><br>


وهذا مثال أخير لاختراق نظام أخر عن طريق ثغرة في المتصفح<br><br>

لاحظ الكتابة الأخيرة session opened وتعني تم فتح جلسة بين الهكر والضحية, والوسيط بيننا هو البايلود shell<br>
تم الاختراق<br>
أوامر اضافية<br>

الامر load و unload<br>
يستعمل الامران في لتشغيل اضافة أو ايقافها مثال<br>
load <plugin name><br>
unload <plugin name><br>
على سبيل المثال سنقوم باضافة الاضافة Nexpose<br><br>

مثال أخر استعمال اضافة  Nessus<br><br>

الامر search<br>
يستعمل في البحث عن موديل معين موجود في الميتاسبلويت<br><br>

هو أم للبحث المتقدم بحيث يمكنك البحث عن موديلات عن طريق الاصناف مثال:<br>
search platform:windows <ما تريد البحث عنه><br>
في الامر السابق بحثنا عن موديل داخل موديلات المتعلقة بالويندوز<br><br>

الامر info<br><br>

نستعمل هذا الامر لمعرفة المزيد من المعلومات عن الثغرة,<br>
info <اسم الثغرة><br>
<br>
الامر show targets<br>
نحتاجه لمعرفة ماهي الانظمة التي تستهدفها الثغرة أو القابلة للاختراق بها, هل هي نظام ويندوز او لينكس وان كان نظام ويندوز.<br>
هل هو ويندوز 7 او 10 او فيستا وغيره. كما تلاحظون بالصورة<br><br>

الامر sessions<br>
ويعني الجلسات وهو مصطلح يطلق عل<br><br>

ى عملية ما بعد الاختراق, فعند اختراق هدف تسمى جلسة, ولمعرفة قائمة الاجهزة التي قمت باختراقها تستعمل الامر<br>
sessions -l<br>
وستظهر لك قائمة list لنفرض أنك تريد التحكم في نظام معين قمت باختراقه وتريد تطبيق اوامر عليه, ستقوم باختياره على حسب رقمه التعريفي id في القائمة<br>
كمثال<br>
sessions -i 1<br>
الحرف i بمعنى interect<br>
sessions<br>

الأمر show payloads<br>
يقوم باستعراض جميع البايلودات وهي أنواع كثيرة, وأشهر واحد هو Meterpreter<br><br>

أنواع البايلود كثثيرة ومختلفة نذكر منها<br><br>

(Inline (Non Staged<br>
Staged<br>
Meterpreter<br>
PassiveX<br>
NoNX<br>
Ord<br>
IPv6<br>
Reflective DLL injection<br><br>

الأمر show encoders<br>
يستعرض لنا جميع خوارزميات وطرق التشفير الموجودة بالميتاسبلويت وهي كثيرة
</form> 
</font> 
</body> 
</html> 